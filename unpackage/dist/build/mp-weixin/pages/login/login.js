(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"02f2":function(e,n,t){"use strict";t.r(n);var r=t("05e4"),a=t("a23e");for(var o in a)["default"].indexOf(o)<0&&function(e){t.d(n,e,(function(){return a[e]}))}(o);t("bfd3");var s=t("828b"),u=Object(s["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);n["default"]=u.exports},"05e4":function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){}));var r=function(){var e=this,n=e.$createElement;e._self._c;e._isMounted||(e.e0=function(n){n.stopPropagation(),e.form.password=""},e.e1=function(n){n.stopPropagation(),e.loginPwdVisible=!e.loginPwdVisible})},a=[]},2925:function(e,n,t){"use strict";(function(e,n){var r=t("47a9");t("d909"),t("861b");r(t("3240"));var a=r(t("02f2"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(a.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},"37a8":function(e,n,t){"use strict";(function(e,r){var a=t("47a9");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=a(t("7eb4")),s=a(t("ee10")),u={data:function(){return{form:{username:"",password:""},loading:!1,loginPwdVisible:!1}},methods:{handleLogin:function(){var n=this;return(0,s.default)(o.default.mark((function t(){var a,s,u;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.form.username.trim()){t.next=3;break}return e.showToast({title:"请输入用户名",icon:"none"}),t.abrupt("return");case 3:if(n.form.password){t.next=6;break}return e.showToast({title:"请输入密码",icon:"none"}),t.abrupt("return");case 6:return t.prev=6,n.loading=!0,t.next=10,r.callFunction({name:"userLogin",data:{username:n.form.username.trim(),password:n.form.password},timeout:1e4});case 10:if(a=t.sent,0!==a.result.code){t.next=21;break}e.showToast({title:"登录成功",icon:"success"}),s=a.result&&a.result.data&&a.result.data.userInfo||{},e.setStorageSync("userInfo",s),u=s&&s.username?String(s.username):"",u&&(e.setStorageSync("username",u),e.setStorageSync("currentUsername",u)),console.log("登录写入本地存储",{hasUserInfo:!!s,username:e.getStorageSync("username")}),setTimeout((function(){e.switchTab({url:"/pages/index/index",fail:function(){return e.reLaunch({url:"/pages/index/index"})}})}),1200),t.next=22;break;case 21:throw new Error(a.result.message||"登录失败");case 22:t.next=28;break;case 24:t.prev=24,t.t0=t["catch"](6),console.error("登录失败:",t.t0),e.showToast({title:t.t0.message||"登录失败，请重试",icon:"none"});case 28:return t.prev=28,n.loading=!1,t.finish(28);case 31:case"end":return t.stop()}}),t,null,[[6,24,28,31]])})))()},navigateToRegister:function(){e.navigateTo({url:"/pages/register/register"})}}};n.default=u}).call(this,t("df3c")["default"],t("861b")["uniCloud"])},a23e:function(e,n,t){"use strict";t.r(n);var r=t("37a8"),a=t.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(o);n["default"]=a.a},bfd3:function(e,n,t){"use strict";var r=t("c5e8"),a=t.n(r);a.a},c5e8:function(e,n,t){}},[["2925","common/runtime","common/vendor"]]]);