(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myActivities/myActivities"],{"646e":function(t,e,a){"use strict";(function(t,e){var n=a("47a9");a("d909"),a("861b");n(a("3240"));var i=n(a("df34"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(i.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])},"6c65":function(t,e,a){"use strict";var n=a("aea8"),i=a.n(n);i.a},aafb:function(t,e,a){"use strict";(function(t,n){var i=a("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(a("7eb4")),c=i(a("af34")),o=i(a("ee10")),u={data:function(){return{activityList:[],loading:!1,page:1,pageSize:10,hasMore:!0,currentUsername:""}},onLoad:function(){this.checkLoginAndLoad()},onShow:function(){},methods:{checkLoginAndLoad:function(){var e=t.getStorageSync("username");e?(this.currentUsername=e,this.page=1,this.hasMore=!0,this.loadActivities()):t.showToast({title:"请先登录",icon:"none",duration:1500,success:function(){setTimeout((function(){t.navigateTo({url:"/pages/login/login"})}),1500)}})},loadActivities:function(){var e=this;return(0,o.default)(r.default.mark((function a(){var i,o,u,s,l;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.loading&&e.hasMore){a.next=2;break}return a.abrupt("return");case 2:if(e.currentUsername){a.next=5;break}return e.checkLoginAndLoad(),a.abrupt("return");case 5:return e.loading=!0,a.prev=6,a.next=9,n.callFunction({name:"getUserActivities",data:{creator:e.currentUsername,page:e.page,pageSize:e.pageSize}});case 9:i=a.sent,console.log("[myActivities] getUserActivities result:",i&&i.result),o=i.result||{},u=o.code,s=o.data,l=o.message,0===u?(1===e.page?e.activityList=s.list||[]:e.activityList=[].concat((0,c.default)(e.activityList),(0,c.default)(s.list||[])),e.hasMore=!!(s&&s.hasMore&&s.list&&s.list.length>0)):t.showToast({title:l||"加载失败，请重试",icon:"none"}),a.next=19;break;case 15:a.prev=15,a.t0=a["catch"](6),console.error("加载活动失败:",a.t0),t.showToast({title:"加载失败，请重试",icon:"none"});case 19:return a.prev=19,e.loading=!1,a.finish(19);case 22:case"end":return a.stop()}}),a,null,[[6,15,19,22]])})))()},loadMore:function(){!this.loading&&this.hasMore&&(this.page++,this.loadActivities())},navigateToDetail:function(e){t.navigateTo({url:"/pages/detailActivity/detailActivity?id=".concat(e)})},navigateToCreate:function(){t.switchTab({url:"/pages/createActivity/createActivity"})},goBack:function(){t.navigateBack()},formatTime:function(t){if(!t)return"";var e=new Date(t),a=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),c=String(e.getMinutes()).padStart(2,"0");return"".concat(a,"-").concat(n,"-").concat(i," ").concat(r,":").concat(c)},fullAddress:function(t){var e=t.area||"",a=t.location||"";if(e||a){var n=a?" "+a:"";return"".concat(e).concat(n)||a}return""}}};e.default=u}).call(this,a("df3c")["default"],a("861b")["uniCloud"])},aea8:function(t,e,a){},d72a:function(t,e,a){"use strict";a.r(e);var n=a("aafb"),i=a.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);e["default"]=i.a},df34:function(t,e,a){"use strict";a.r(e);var n=a("f182"),i=a("d72a");for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);a("6c65");var c=a("828b"),o=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=o.exports},f182:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,a=(t._self._c,t.activityList.length),n=a>0?t.__map(t.activityList,(function(e,a){var n=t.__get_orig(e),i=t.fullAddress(e),r=t.formatTime(e.createdAt);return{$orig:n,m0:i,m1:r}})):null,i=a>0&&!t.hasMore?!t.loading&&t.activityList.length>0:null;t.$mp.data=Object.assign({},{$root:{g0:a,l0:n,g1:i}})},i=[]}},[["646e","common/runtime","common/vendor"]]]);