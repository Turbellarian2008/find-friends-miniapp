{"version":3,"sources":["uni-app:///main.js","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/editActivity/editActivity.vue?870f","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/editActivity/editActivity.vue?827e","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/editActivity/editActivity.vue?d82c","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/editActivity/editActivity.vue?ccfb","uni-app:///pages/editActivity/editActivity.vue","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/editActivity/editActivity.vue?c764","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/editActivity/editActivity.vue?6762"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","activityId","form","name","date","timeSlot","endtime","contact","totalPeople","description","type","originalLocation","districtOptions","districtIndex","detailAddress","hours","length","minutes","startPickerIndex","endHours","endMinutes","endPickerIndex","endPlaceholder","peopleOptions","peopleIndex","typeOptions","computed","isFormValid","assembledLocation","displayLocation","onLoad","uni","title","content","showCancel","complete","ec","methods","prefill","loadDetail","uniCloud","id","res","console","onDateChange","onPeopleChange","onDistrictChange","parseLocation","onSubmitTap","reason","icon","firstInvalidReason","onTypeSelect","submit","username","mask","area","location","setTimeout","compareTime","h","m","isTodaySelected","getMinStartForSelectedDate","getStartMinutesForHour","minH","minM","rebuildStartColumns","mIdx","onStartMultiColumnChange","column","value","onStartMultiChange","hIdx","getStartHM","startH","startM","getEndMinutesForHour","rebuildEndColumns","onEndMultiColumnChange","onEndMultiChange","addOneMinute","hh","mm","setEndTimeDefault","applyStartIndexFromValue","applyEndIndexFromValue"],"mappings":"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IACA4B;MACA;QACA;UAAA;UAAAC;UAAAC;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;UAAA;QAAA;QAAA;QAAAC;QAAAC;MACA;MACA;QACA;UAAAlD;QAAA;UAAA;QAAA;MACA;MACA;QAAAA;MAAA;QAAA;MAAA;IACA;IACAmD;MACA;MACA;UAAA;QAAA;QAAA;QAAAF;MACA;MACA;QAAAjD;MAAA;QAAA;MAAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACAoD;MACA;MACA;IACA;IACAC;MACA;QAAAC;QAAAC;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;MACA;MACA;IACA;IACAC;MACA;QAAAC;QAAAL;MACA;MACA;MACA;IACA;IACAM;MACA;QACA;UAAA;UAAAd;UAAAC;QACA;UAAAc;UAAAC;QAAA;MACA;MACA;MACA;MACA;QAAAD;QAAAC;MAAA;IACA;IACAC;MACA;QAAAF;QAAAC;MACA;MACA;MACA;QACA;QACA;QACA;UAAA5D;QAAA;UAAA;QAAA;MACA;MACA;QAAAA;MAAA;QAAA;MAAA;IACA;IACA8D;MACA;QAAAH;QAAAC;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;MACA;MACA;QAAA5D;MAAA;QAAA;MAAA;MACA;MACA;MACA;QACA;QACA;UACA;UACA;QACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA;QACA;MACA;IACA;IACA+D;MACA;MACA;QAAAT;QAAAC;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;MACA;IACA;IACAS;MACA;QAAAP;QAAAL;MACA;MACA;MACA;IACA;IACAa;MACA;MACA;MACA;QAAAC;QAAAC;MAAA;MACA;QAAAvB;QAAAC;MAAA;IACA;IACAuB;MACA;QACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;QAAA;QAAAzB;QAAAC;MACA;MACA;MACA;MACA;IACA;IACAyB;MACA;MACA;MACA;QAAA;QAAA1B;QAAAC;MACA;MACA;MACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACveA;AAAA;AAAA;AAAA;AAAurC,CAAgB,umCAAG,EAAC,C;;;;;;;;;;;ACA3sC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/editActivity/editActivity.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/editActivity/editActivity.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./editActivity.vue?vue&type=template&id=7ea72ca6&\"\nvar renderjs\nimport script from \"./editActivity.vue?vue&type=script&lang=js&\"\nexport * from \"./editActivity.vue?vue&type=script&lang=js&\"\nimport style0 from \"./editActivity.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/editActivity/editActivity.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./editActivity.vue?vue&type=template&id=7ea72ca6&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./editActivity.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./editActivity.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"container\">\n    <view class=\"form-item\">\n      <text class=\"label\">活动名称</text>\n      <input class=\"input\" v-model=\"form.name\" placeholder=\"请输入活动名称\" />\n    </view>\n\n    <view class=\"form-item\">\n      <text class=\"label\">活动类型</text>\n      <view class=\"type-list\">\n        <view\n          class=\"type-item\"\n          v-for=\"t in typeOptions\"\n          :key=\"t\"\n          :class=\"{ active: form.type === t }\"\n          @tap=\"onTypeSelect(t)\"\n        >\n          {{ t }}\n        </view>\n      </view>\n    </view>\n\n    <view class=\"form-item\">\n      <text class=\"label\">活动所在区</text>\n      <picker mode=\"selector\" :range=\"districtOptions\" :value=\"districtIndex\" @change=\"onDistrictChange\">\n        <view class=\"picker\">{{ districtIndex >= 0 ? districtOptions[districtIndex] : '请选择区' }}</view>\n      </picker>\n    </view>\n    <view class=\"form-item\">\n      <text class=\"label\">详细地址</text>\n      <input class=\"input\" v-model=\"detailAddress\" placeholder=\"请输入详细地址\" />\n    </view>\n    <view class=\"form-item\">\n      <text class=\"label\">地点预览</text>\n      <view class=\"picker\">{{ displayLocation }}</view>\n    </view>\n\n    <view class=\"form-item\">\n      <text class=\"label\">活动日期</text>\n      <picker mode=\"date\" @change=\"onDateChange\">\n        <view class=\"picker\">{{ form.date || '请选择日期' }}</view>\n      </picker>\n    </view>\n\n    <view class=\"form-item\">\n      <text class=\"label\">活动开始时间</text>\n      <picker \n        mode=\"multiSelector\" \n        :range=\"[hours, ['：'], minutes]\" \n        :value=\"startPickerIndex\"\n        @change=\"onStartMultiChange\"\n        @columnchange=\"onStartMultiColumnChange\"\n      >\n        <view class=\"picker\">{{ form.timeSlot || '请选择开始时间' }}</view>\n      </picker>\n    </view>\n\n    <view class=\"form-item\">\n      <text class=\"label\">活动结束时间</text>\n      <picker \n        mode=\"multiSelector\" \n        :range=\"[endHours, ['：'], endMinutes]\" \n        :value=\"endPickerIndex\"\n        @change=\"onEndMultiChange\"\n        @columnchange=\"onEndMultiColumnChange\"\n      >\n        <view class=\"picker\">{{ form.endtime || '请选择结束时间' }}</view>\n      </picker>\n    </view>\n\n    <view class=\"form-item\">\n      <text class=\"label\">联系方式</text>\n      <input class=\"input\" v-model=\"form.contact\" placeholder=\"请输入手机号\" type=\"number\" maxlength=\"11\" />\n    </view>\n\n    <view class=\"form-item\">\n      <text class=\"label\">活动人数</text>\n      <picker \n        class=\"picker\" \n        :range=\"peopleOptions\" \n        @change=\"onPeopleChange\"\n        :value=\"peopleIndex\"\n      >\n        <view class=\"picker-text\">\n          {{ form.totalPeople ? `${form.totalPeople}人` : '请选择活动人数' }}\n        </view>\n      </picker>\n    </view>\n\n    <view class=\"form-item\">\n      <text class=\"label\">详细说明</text>\n      <textarea class=\"textarea\" v-model=\"form.description\" placeholder=\"请输入详细说明\"></textarea>\n    </view>\n\n    <button class=\"submit-button\" :class=\"isFormValid ? 'enabled' : 'disabled'\" @tap=\"onSubmitTap\">保存修改</button>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      activityId: '',\n      form: {\n        name: '',\n        date: '',\n        timeSlot: '',\n        endtime: '',\n        contact: '',\n        totalPeople: '',\n        description: '',\n        type: ''\n      },\n      originalLocation: '',\n      // 地点联动（仅区 + 详细地址）\n      districtOptions: ['越秀区','荔湾区','海珠区','天河区','白云区','黄埔区','番禺区','花都区','南沙区','从化区','增城区'],\n      districtIndex: -1,\n      detailAddress: '',\n      // 多列时间选择数组\n      hours: Array.from({ length: 24 }, (_, i) => String(i).padStart(2, '0')),\n      minutes: Array.from({ length: 60 }, (_, i) => String(i).padStart(2, '0')),\n      startPickerIndex: [0, 0, 0],\n      endHours: [],\n      endMinutes: [],\n      endPickerIndex: [0, 0, 0],\n      endPlaceholder: false,\n      peopleOptions: ['2','3','4','5','6','7','8','9','10','12','15','20','30','50'],\n      peopleIndex: -1,\n      typeOptions: ['室内运动','户外运动','音乐','艺术','娱乐','其他']\n    }\n  },\n  computed: {\n    isFormValid() {\n      if (!this.form.name || !this.form.name.trim()) return false;\n      if (this.districtIndex < 0) return false;\n      if (!this.detailAddress || !this.detailAddress.trim()) return false;\n      if (!this.form.date) return false;\n      if (!this.form.timeSlot) return false;\n      if (!this.form.endtime) return false;\n      if (this.compareTime(this.form.endtime, this.form.timeSlot) <= 0) return false;\n      if (!/^\\d{11}$/.test(this.form.contact)) return false;\n      if (!this.form.totalPeople || Number(this.form.totalPeople) <= 0) return false;\n      if (!this.form.description || !this.form.description.trim()) return false;\n      if (!this.form.type) return false;\n      return true;\n    },\n    assembledLocation() {\n      if (this.districtIndex < 0) return '';\n      const district = this.districtOptions[this.districtIndex];\n      const detail = (this.detailAddress || '').trim();\n      if (!detail) return `广东省广州市${district}`;\n      return `广东省广州市${district} ${detail}`;\n    },\n    displayLocation() {\n      return this.assembledLocation || this.originalLocation || '';\n    }\n  },\n  onLoad(options) {\n    if (!options || !options.id) {\n      uni.showModal({ title: '错误', content: '缺少活动ID', showCancel: false, complete: () => uni.navigateBack() });\n      return;\n    }\n    this.activityId = options.id;\n\n    // 通过 eventChannel 预填\n    try {\n      const ec = this.getOpenerEventChannel && this.getOpenerEventChannel();\n      if (ec && ec.on) {\n        ec.on('activityPrefill', ({ activity }) => {\n          if (activity) this.prefill(activity);\n        })\n      }\n    } catch(_) {}\n\n    // 再次从后端拉取最新数据\n    this.loadDetail();\n  },\n  methods: {\n    prefill(activity) {\n      const f = {\n        name: activity.name || '',\n        date: activity.date || '',\n        timeSlot: activity.timeSlot || '',\n        endtime: activity.endtime || '',\n        contact: activity.contact || '',\n        totalPeople: activity.totalPeople || '',\n        description: activity.description || '',\n        type: activity.type || ''\n      };\n      this.form = { ...this.form, ...f };\n      // 优先使用拆分字段进行预填\n      const area = activity.area || '';\n      const detail = activity.location || '';\n      if (area) {\n        const dIdx = this.districtOptions.findIndex(d => String(d) === String(area));\n        this.districtIndex = dIdx;\n        // 无街道选择，直接填充详细地址\n        this.detailAddress = detail || '';\n        // 组装一个显示用的原始地址\n        const assembled = `广东省广州市${area}${detail ? (' ' + detail) : ''}`;\n        this.originalLocation = assembled;\n      } else {\n        // 回退：解析旧的合并地址\n        this.originalLocation = activity.location || '';\n        this.parseLocation(this.originalLocation);\n      }\n      // peopleIndex\n      const idx = this.peopleOptions.findIndex(v => Number(v) === Number(f.totalPeople));\n      this.peopleIndex = idx;\n      // 初始化列（占位，后续完善逻辑）\n      this.rebuildStartColumns();\n      this.applyStartIndexFromValue();\n      this.rebuildEndColumns();\n      this.applyEndIndexFromValue();\n    },\n    async loadDetail() {\n      try {\n        const res = await uniCloud.callFunction({ name: 'getActivityDetail', data: { id: this.activityId } });\n        if (res.result && res.result.code === 0 && res.result.data) {\n          this.prefill(res.result.data);\n        }\n      } catch(e) {\n        console.warn('加载详情失败', e);\n      }\n    },\n    onDateChange(e) {\n      this.form.date = e.detail.value;\n      this.rebuildStartColumns();\n      this.rebuildEndColumns();\n    },\n    onPeopleChange(e) {\n      this.peopleIndex = Number(e.detail.value);\n      this.form.totalPeople = Number(this.peopleOptions[this.peopleIndex]);\n    },\n    onDistrictChange(e) {\n      this.districtIndex = Number(e.detail.value);\n    },\n    parseLocation(location) {\n      try {\n        if (!location) return;\n        // 归一化：去空格、去省市\n        const raw = String(location);\n        const normalized = raw.replace(/\\s+/g, '').replace('广东省','').replace('广州市','');\n        // 找区\n        const dIdx = this.districtOptions.findIndex(d => normalized.includes(d));\n        if (dIdx >= 0) {\n          this.districtIndex = dIdx;\n          const dName = this.districtOptions[dIdx];\n          // 无街道：区名后的剩余内容即为详细地址\n          const after = normalized.split(dName)[1] || '';\n          this.detailAddress = (after || '').trim();\n        }\n      } catch (_) {}\n    },\n    onSubmitTap() {\n      if (this.isFormValid) {\n        this.submit();\n      } else {\n        const reason = this.firstInvalidReason();\n        reason && uni.showToast({ title: reason, icon: 'none' });\n      }\n    },\n    firstInvalidReason() {\n      if (!this.form.name || !this.form.name.trim()) return '请填写活动名称';\n      if (this.districtIndex < 0) return '请选择活动所在区';\n      if (!this.detailAddress || !this.detailAddress.trim()) return '请填写详细地址';\n      if (!this.form.date) return '请选择活动日期';\n      if (!this.form.timeSlot) return '请选择开始时间';\n      if (!this.form.endtime) return '请选择结束时间';\n      if (this.compareTime(this.form.endtime, this.form.timeSlot) <= 0) return '结束时间需晚于开始时间';\n      if (!/^\\d{11}$/.test(this.form.contact)) return '请输入11位手机号';\n      if (!this.form.totalPeople || Number(this.form.totalPeople) <= 0) return '请选择活动人数';\n      if (!this.form.description || !this.form.description.trim()) return '请填写详细说明';\n      if (!this.form.type) return '请选择活动类型';\n      return '';\n    },\n    onTypeSelect(t) {\n      this.form.type = t;\n    },\n    async submit() {\n      const username = uni.getStorageSync('username') || '';\n      if (!username) {\n        uni.showToast({ title: '请先登录', icon: 'none' });\n        return;\n      }\n      try {\n        uni.showLoading({ title: '保存中...', mask: true });\n        const res = await uniCloud.callFunction({\n          name: 'updateActivity',\n          data: {\n            id: this.activityId,\n            username,\n            ...this.form,\n            // 拆分后的地址字段\n            area: this.districtIndex >= 0 ? this.districtOptions[this.districtIndex] : '',\n            location: (this.detailAddress || '').trim()\n          }\n        });\n        if (res.result && res.result.code === 0) {\n          uni.showToast({ title: '保存成功', icon: 'success' });\n          setTimeout(() => {\n            // 返回详情页并刷新\n            uni.navigateBack();\n          }, 800);\n        } else {\n          throw new Error((res.result && res.result.message) || '保存失败');\n        }\n      } catch (e) {\n        uni.showToast({ title: e.message || '保存失败', icon: 'none' });\n      } finally {\n        uni.hideLoading();\n      }\n    },\n    // —— 时间选择相关占位方法（后续完善逻辑） ——\n    compareTime(a, b) {\n      const toMin = (t) => {\n        const [h, m] = String(t || '00:00').split(':');\n        return (parseInt(h, 10) || 0) * 60 + (parseInt(m, 10) || 0);\n      };\n      return toMin(a) - toMin(b);\n    },\n    isTodaySelected() {\n      if (!this.form.date) return false;\n      const d = new Date();\n      const y = d.getFullYear();\n      const m = String(d.getMonth() + 1).padStart(2, '0');\n      const da = String(d.getDate()).padStart(2, '0');\n      return this.form.date === `${y}-${m}-${da}`;\n    },\n    getMinStartForSelectedDate() {\n      if (this.isTodaySelected()) {\n        const now = new Date();\n        return `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;\n      }\n      return '00:00';\n    },\n    getStartMinutesForHour(h) {\n      const minStart = this.getMinStartForSelectedDate();\n      const [minH, minM] = minStart.split(':').map(s => parseInt(s, 10));\n      const hourNum = parseInt(h, 10);\n      if (this.isTodaySelected() && hourNum === minH) {\n        return Array.from({ length: 60 - minM }, (_, i) => String(minM + i).padStart(2, '0'));\n      }\n      return Array.from({ length: 60 }, (_, i) => String(i).padStart(2, '0'));\n    },\n    rebuildStartColumns() {\n      const minStart = this.getMinStartForSelectedDate();\n      const [minH] = minStart.split(':').map(s => parseInt(s, 10));\n      // hours from minH..23\n      this.hours = Array.from({ length: 24 - minH }, (_, i) => String(minH + i).padStart(2, '0'));\n      // keep current hour if possible\n      const curHour = (this.form.timeSlot || '').split(':')[0];\n      const hIdx = Math.max(0, this.hours.indexOf(curHour));\n      const h = this.hours[hIdx] || this.hours[0];\n      this.minutes = this.getStartMinutesForHour(h);\n      let mIdx = 0;\n      const curMin = (this.form.timeSlot || '').split(':')[1];\n      if (curMin) {\n        const found = this.minutes.indexOf(curMin);\n        mIdx = found >= 0 ? found : 0;\n      }\n      this.startPickerIndex = [hIdx, 0, Math.max(0, Math.min(mIdx, this.minutes.length - 1))];\n    },\n    onStartMultiColumnChange(e) {\n      const { column, value } = e.detail;\n      const idx = [...this.startPickerIndex];\n      if (column === 0) idx[0] = value;\n      if (column === 2) idx[2] = value;\n      this.startPickerIndex = idx;\n      if (column === 0) {\n        const h = this.hours[this.startPickerIndex[0]];\n        this.minutes = this.getStartMinutesForHour(h);\n        if (this.startPickerIndex[2] >= this.minutes.length) this.startPickerIndex[2] = 0;\n      }\n      this.rebuildEndColumns();\n    },\n    onStartMultiChange(e) {\n      const [hIdx, , mIdx] = e.detail.value;\n      const h = this.hours[hIdx] || '00';\n      const m = this.minutes[mIdx] || '00';\n      this.form.timeSlot = `${h}:${m}`;\n    },\n    getStartHM() {\n      if (this.form.timeSlot) {\n        const [h, m] = this.form.timeSlot.split(':');\n        return { startH: h, startM: m };\n      }\n      const h = this.hours[this.startPickerIndex[0]] || '00';\n      const m = this.minutes[this.startPickerIndex[2]] || '00';\n      return { startH: h, startM: m };\n    },\n    getEndMinutesForHour(h) {\n      const { startH, startM } = this.getStartHM();\n      const hourNum = parseInt(h, 10);\n      const sHourNum = parseInt(startH, 10);\n      if (hourNum === sHourNum) {\n        const sMin = parseInt(startM, 10);\n        if (sMin >= 59) return [];\n        return Array.from({ length: 59 - sMin }, (_, i) => String(sMin + 1 + i).padStart(2, '0'));\n      }\n      return Array.from({ length: 60 }, (_, i) => String(i).padStart(2, '0'));\n    },\n    rebuildEndColumns() {\n      const { startH, startM } = this.getStartHM();\n      const sHourNum = parseInt(startH || '0', 10);\n      // hours from startH..23, but if startM==59, effectively start from next hour\n      let beginHour = sHourNum;\n      if (parseInt((startM || '0'), 10) >= 59) beginHour = sHourNum + 1;\n      if (beginHour > 23) {\n        // no valid end time today\n        this.endPlaceholder = true;\n        this.endHours = ['--'];\n        this.endMinutes = ['--'];\n        this.endPickerIndex = [0, 0, 0];\n        return;\n      }\n      this.endPlaceholder = false;\n      this.endHours = Array.from({ length: 24 - beginHour }, (_, i) => String(beginHour + i).padStart(2, '0'));\n      const firstH = this.endHours[0];\n      this.endMinutes = this.getEndMinutesForHour(firstH);\n      if (this.endMinutes.length === 0) {\n        // move to next hour if same-hour minutes empty\n        if (this.endHours.length > 1) {\n          this.endMinutes = this.getEndMinutesForHour(this.endHours[1]);\n          this.endPickerIndex = [1, 0, 0];\n        } else {\n          this.endPlaceholder = true;\n          this.endHours = ['--'];\n          this.endMinutes = ['--'];\n          this.endPickerIndex = [0, 0, 0];\n          return;\n        }\n      } else {\n        this.endPickerIndex = [0, 0, 0];\n      }\n    },\n    onEndMultiColumnChange(e) {\n      if (this.endPlaceholder) return;\n      const { column, value } = e.detail;\n      const idx = [...this.endPickerIndex];\n      if (column === 0) idx[0] = value;\n      if (column === 2) idx[2] = value;\n      this.endPickerIndex = idx;\n      if (column === 0) {\n        const h = this.endHours[this.endPickerIndex[0]];\n        this.endMinutes = this.getEndMinutesForHour(h);\n        if (this.endPickerIndex[2] >= this.endMinutes.length) this.endPickerIndex[2] = 0;\n      }\n    },\n    onEndMultiChange(e) {\n      const [hIdx, , mIdx] = e.detail.value;\n      const h = (this.endHours[hIdx] || this.hours[hIdx] || '00');\n      const m = (this.endMinutes[mIdx] || this.minutes[mIdx] || '00');\n      this.form.endtime = `${h}:${m}`;\n    },\n    addOneMinute(h, m) {\n      let hh = parseInt(h, 10);\n      let mm = parseInt(m, 10) + 1;\n      if (mm >= 60) { hh += 1; mm = 0; }\n      return { h: String(hh).padStart(2, '0'), m: String(mm).padStart(2, '0') };\n    },\n    setEndTimeDefault(h, m) {\n      if (parseInt(h, 10) > 23) {\n        this.form.endtime = '';\n        return;\n      }\n      this.form.endtime = `${h}:${m}`;\n    },\n    applyStartIndexFromValue() {\n      const val = this.form.timeSlot;\n      if (!val) return;\n      const [h, m] = val.split(':');\n      const hIdx = Math.max(0, this.hours.indexOf(h));\n      this.minutes = this.getStartMinutesForHour(this.hours[hIdx]);\n      const mIdx = Math.max(0, this.minutes.indexOf(m));\n      this.startPickerIndex = [hIdx, 0, mIdx];\n    },\n    applyEndIndexFromValue() {\n      const val = this.form.endtime;\n      if (!val || this.endPlaceholder) return;\n      const [h, m] = val.split(':');\n      const hIdx = Math.max(0, this.endHours.indexOf(h));\n      this.endMinutes = this.getEndMinutesForHour(this.endHours[hIdx] || h);\n      const mIdx = Math.max(0, this.endMinutes.indexOf(m));\n      this.endPickerIndex = [hIdx, 0, mIdx];\n    }\n  }\n}\n</script>\n\n<style>\n.container { padding: 30rpx; }\n.form-item { margin-bottom: 24rpx; }\n.label { display: block; font-size: 28rpx; color: #333; margin-bottom: 12rpx; }\n.input { background: #fff; padding: 20rpx; border-radius: 12rpx; font-size: 28rpx; }\n.textarea { background: #fff; padding: 20rpx; border-radius: 12rpx; font-size: 28rpx; min-height: 180rpx; }\n.picker { background: #fff; padding: 20rpx; border-radius: 12rpx; font-size: 28rpx; color: #666; }\n.picker-text { font-size: 28rpx; color: #666; }\n.submit-button { margin-top: 30rpx; height: 90rpx; border-radius: 12rpx; color: #fff; font-size: 32rpx; display: flex; align-items: center; justify-content: center; }\n.submit-button.enabled { background-color: #4CAF50; }\n.submit-button.disabled { background-color: #c8c9cc; }\n\n /* 活动类型按钮样式（与创建页一致，允许换行） */\n .type-list {\n   width: 94%;\n   display: flex;\n   flex-wrap: wrap;\n   gap: 16rpx;\n   margin: 0 auto;\n }\n .type-item {\n   padding: 16rpx 28rpx;\n   border: 2rpx solid #e0e0e0;\n   border-radius: 999rpx;\n   font-size: 28rpx;\n   background-color: #fff;\n   color: #333;\n   box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.05);\n }\n .type-item.active {\n   background: #e6f7ff;\n   border-color: #91d5ff;\n   color: #1890ff;\n   box-shadow: 0 2rpx 10rpx rgba(24,144,255,0.2);\n }\n .type-item:active {\n   opacity: 0.9;\n   transform: scale(0.98);\n }\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./editActivity.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./editActivity.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1755337402616\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}