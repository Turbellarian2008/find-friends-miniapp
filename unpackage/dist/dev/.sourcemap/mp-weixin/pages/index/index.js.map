{"version":3,"sources":["webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/index/index.vue?d822","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/index/index.vue?c668","uni-app:///main.js","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/index/index.vue?2d80","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/index/index.vue?9a33","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/index/index.vue?f5a4","webpack:////Users/Turbellarian/Documents/HBuilderProjects/find-friends-miniapp/pages/index/index.vue?eace","uni-app:///pages/index/index.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","selectedDate","selectedStartTime","selectedAreaIndex","selectedTypeIndex","areas","types","searchQuery","tempDatePickerValue","filterDrawerVisible","filterActiveTab","tempSelectedDate","tempSelectedStartTime","tempHours","tempMinutes","tempStartPickerIndex","tempSelectedAreaIndex","tempSelectedTypeIndex","dateOptions","hours","length","minutes","startPickerIndex","activityList","refreshing","loading","computed","displayedActivities","onLoad","onShow","console","onPullDownRefresh","methods","fullLocation","onDateChange","openFilterDrawer","closeFilterDrawer","onClearTempFilters","onConfirmTempFilters","clearTempDate","onTempDatePicked","getMinStartForTempDate","rebuildTempStartColumns","minH","minM","getTempMinutesForHour","onTempStartTimeMultiChange","hIdx","_sep","mIdx","onTempStartTimeMultiColumnChange","column","value","isTodaySelected","getMinStartForSelectedDate","rebuildStartColumns","getStartMinutesForHour","onStartTimeMultiChange","_uh","onStartTimeMultiColumnChange","formatDate","compareTime","h","m","loadActivities","uni","title","timestamp","uniCloud","name","_t","timeout","res","activity","id","dates","icon","duration","onAreaChange","viewDetail","url","success","fail","createActivity","resetFilters","loadActivityDetail"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAgrC,CAAgB,gmCAAG,EAAC,C;;;;;;;;;;;ACApsC;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;;;;ACNL;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACa;;;AAGjE;AACgN;AAChN,gBAAgB,iNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtDA;AAAA;AAAA;AAAA;AAAm0B,CAAgB,myBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eCsHv1B;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;MAAA;MACAC;MACA;MACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;QAAAC;MAAA;QAAA;MAAA;MACAC;QAAAD;MAAA;QAAA;MAAA;MACAE;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;;EACAC;IACAC;MAAA;MACA;QACA;MACA;;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;EACA;EACAC;IACA;IACAC;IACA;EACA;EACAC;IACA;IACA;EACA;EACAC;IACAC;MACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;QAAA;MAAA;IACA;IACAC;MACA;MACAJ;MACA;MACA;QACA;QACA;QACA;UACA;QACA;MACA;IACA;IACAK;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;QACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;UAAA;QAAA;QAAA;QAAAC;QAAAC;MACA;QAAAxB;MAAA;QAAA;MAAA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAyB;MACA;MACA;UAAA;QAAA;QAAA;QAAAF;QAAAC;MACA;MACA;QACA;UAAAxB;QAAA;UAAA;QAAA;MACA;MACA;QAAAA;MAAA;QAAA;MAAA;IACA;IACA0B;MACA;QAAAC;QAAAC;QAAAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;QAAAC;QAAAC;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;QACA;QACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;UAAA;QAAA;QAAA;QAAAZ;QAAAC;MACA;MACA;QAAAxB;MAAA;QAAA;MAAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAoC;MACA;MACA;UAAA;QAAA;QAAA;QAAAb;QAAAC;MACA;MACA;QACA;UAAAxB;QAAA;UAAA;QAAA;MACA;MACA;QAAAA;MAAA;QAAA;MAAA;IACA;IACAqC;MACA;QAAAV;QAAAW;QAAAT;MACA;MACA;MACA;MACA;IACA;IACAU;MACA;QAAAR;QAAAC;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;UACA;QACA;MACA;IACA;IACAQ;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;UAAA;UAAAC;UAAAC;QACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAlC;gBACA;gBACAmC;kBAAAC;gBAAA;;gBAEA;gBACAC;gBAAA;gBAAA,OAEAC;kBACAC;kBACArE;oBAAAsE;kBAAA;kBAAA;kBACAC;gBACA;cAAA;gBAJAC;gBAMA1C;gBAAA,MAEA0C;kBAAA;kBAAA;gBAAA;gBACA;gBACA;kBAAA,uCACAC;oBACAC;kBAAA;gBAAA,CACA;gBACA;gBACAC;kBAAA;gBAAA;gBACA;kBAAAA;gBAAA;gBACA;gBACA;;gBAEA7C;gBAAA;gBAAA;cAAA;gBAAA,MAEA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAA;gBACAmC;kBACAC;kBACAU;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBACA;gBACAZ;gBACA;gBACAA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACAa;MACA;MACAhD;IACA;IACAiD;MACA;MACAjD;MACA;MACA;MACA;QACA;QACA2C;UAAA;QAAA;MACA;MACA;QACA;QACA;QACAA;MACA;MACA;QACA3C;QACAmC;UACAC;UACAU;UACAC;QACA;QACA;MACA;MACA;MACA;QACA/C;QACAmC;UACAC;UACAU;UACAC;QACA;QACA;MACA;MACA;MACA/C;QAAA4C;QAAAM;MAAA;MACAf;QACAe;QACAC;UACA;YACA;YACAT;cAAAC;YAAA;UACA;YACA3C;UACA;QACA;QACAoD;UACApD;UACAmC;YACAC;YACAU;YACAC;UACA;QACA;MACA;IACA;IACAM;MACArD;MACAmC;QACAe;QACAE;UACApD;UACAmC;YACAC;YACAU;UACA;QACA;MACA;IACA;IACAQ;MACA;MACA;MACA;MACA;MACAnB;QACAC;QACAU;MACA;IACA;IACAS;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEAjB;kBACAC;kBACArE;oBAAA0E;kBAAA;gBACA;cAAA;gBAHAF;gBAIA1C;gBAAA,MACA0C;kBAAA;kBAAA;gBAAA;gBACA;gBAAA;gBAAA;cAAA;gBAAA,MAEA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGA1C;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EACA;AACA;AAAA,2B","file":"pages/index/index.js","sourcesContent":["import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1755337402618\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=57280228&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=57280228&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.displayedActivities, function (activity, index) {\n    var $orig = _vm.__get_orig(activity)\n    var m0 = _vm.fullLocation(activity)\n    return {\n      $orig: $orig,\n      m0: m0,\n    }\n  })\n  var g0 = !_vm.loading && _vm.activityList.length === 0\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      _vm.filterActiveTab = \"date\"\n    }\n    _vm.e1 = function ($event) {\n      _vm.filterActiveTab = \"time\"\n    }\n    _vm.e2 = function ($event) {\n      _vm.filterActiveTab = \"area\"\n    }\n    _vm.e3 = function ($event) {\n      _vm.filterActiveTab = \"type\"\n    }\n    _vm.e4 = function ($event, idx) {\n      var _temp = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp2 = _temp.eventParams || _temp[\"event-params\"],\n        idx = _temp2.idx\n      var _temp, _temp2\n      _vm.tempSelectedAreaIndex = idx\n    }\n    _vm.e5 = function ($event, idx) {\n      var _temp3 = arguments[arguments.length - 1].currentTarget.dataset,\n        _temp4 = _temp3.eventParams || _temp3[\"event-params\"],\n        idx = _temp4.idx\n      var _temp3, _temp4\n      _vm.tempSelectedTypeIndex = idx\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"activities-container\">\n\t\t<!-- 下拉刷新区域 -->\n\t\t<view class=\"refresh-container\" v-if=\"refreshing\">\n\t\t\t<text class=\"refresh-text\">刷新中...</text>\n\t\t</view>\n\n\t\t<!-- 侧边筛选抽屉 -->\n\t\t<view v-if=\"filterDrawerVisible\" class=\"drawer-mask\" @click=\"closeFilterDrawer\"></view>\n\t\t<view class=\"filter-drawer\" :class=\"{ show: filterDrawerVisible }\">\n\t\t\t<view class=\"drawer-header\">筛选</view>\n\t\t\t<view class=\"drawer-body\">\n\t\t\t\t<!-- 左侧分类 -->\n\t\t\t\t<view class=\"drawer-left\">\n\t\t\t\t\t<view \n\t\t\t\t\t\tclass=\"drawer-tab\" \n\t\t\t\t\t\t:class=\"{ active: filterActiveTab === 'date' }\"\n\t\t\t\t\t\t@click=\"filterActiveTab = 'date'\"\n\t\t\t\t\t>日期</view>\n\t\t\t\t\t<view \n\t\t\t\t\t\tclass=\"drawer-tab\" \n\t\t\t\t\t\t:class=\"{ active: filterActiveTab === 'time' }\"\n\t\t\t\t\t\t@click=\"filterActiveTab = 'time'\"\n\t\t\t\t\t>开始时间</view>\n\t\t\t\t\t<view \n\t\t\t\t\t\tclass=\"drawer-tab\" \n\t\t\t\t\t\t:class=\"{ active: filterActiveTab === 'area' }\"\n\t\t\t\t\t\t@click=\"filterActiveTab = 'area'\"\n\t\t\t\t\t>地区</view>\n\t\t\t\t\t<view \n\t\t\t\t\t\tclass=\"drawer-tab\" \n\t\t\t\t\t\t:class=\"{ active: filterActiveTab === 'type' }\"\n\t\t\t\t\t\t@click=\"filterActiveTab = 'type'\"\n\t\t\t\t\t>类别</view>\n\t\t\t\t</view>\n\t\t\t\t<!-- 右侧选项 -->\n\t\t\t\t<view class=\"drawer-right\">\n\t\t\t\t\t<!-- 日期选项：仅“选择”（底部弹出日历，纵向排列） -->\n\t\t\t\t\t<view v-if=\"filterActiveTab === 'date'\" class=\"option-list option-list-column\">\n\t\t\t\t\t\t<picker mode=\"date\" :value=\"tempDatePickerValue\" @change=\"onTempDatePicked\">\n\t\t\t\t\t\t\t<view class=\"option-item\" :class=\"{ selected: !!tempSelectedDate }\">\n\t\t\t\t\t\t\t\t{{ tempSelectedDate || '选择' }}\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</picker>\n\t\t\t\t\t</view>\n\t\t\t\t\t<!-- 开始时间选项：多列选择器（小时：分钟），受日期约束 -->\n\t\t\t\t\t<view v-else-if=\"filterActiveTab === 'time'\" class=\"option-list option-list-column\">\n\t\t\t\t\t\t<picker \n\t\t\t\t\t\t\tmode=\"multiSelector\"\n\t\t\t\t\t\t\t:range=\"[tempHours, ['：'], tempMinutes]\"\n\t\t\t\t\t\t\t:value=\"tempStartPickerIndex\"\n\t\t\t\t\t\t\t@change=\"onTempStartTimeMultiChange\"\n\t\t\t\t\t\t\t@columnchange=\"onTempStartTimeMultiColumnChange\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"option-item\" :class=\"{ selected: !!tempSelectedStartTime }\">\n\t\t\t\t\t\t\t\t{{ tempSelectedStartTime || '选择开始时间' }}\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</picker>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<!-- 地区选项（移除“不限”） -->\n\t\t\t\t\t<view v-else-if=\"filterActiveTab === 'area'\" class=\"option-list\">\n\t\t\t\t\t\t<view \n\t\t\t\t\t\t\tv-for=\"(a, idx) in areas\" :key=\"'a-'+idx\"\n\t\t\t\t\t\t\tclass=\"option-item\" \n\t\t\t\t\t\t\t:class=\"{ selected: tempSelectedAreaIndex === idx }\"\n\t\t\t\t\t\t\t@click=\"tempSelectedAreaIndex = idx\"\n\t\t\t\t\t\t>{{ a }}</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<!-- 类别选项（活动类型） -->\n\t\t\t\t\t<view v-else-if=\"filterActiveTab === 'type'\" class=\"option-list\">\n\t\t\t\t\t\t<view \n\t\t\t\t\t\t\tv-for=\"(t, idx) in types\" :key=\"'type-'+idx\"\n\t\t\t\t\t\t\tclass=\"option-item\" \n\t\t\t\t\t\t\t:class=\"{ selected: tempSelectedTypeIndex === idx }\"\n\t\t\t\t\t\t\t@click=\"tempSelectedTypeIndex = idx\"\n\t\t\t\t\t\t>{{ t }}</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view class=\"drawer-actions\">\n\t\t\t\t<button class=\"btn-clear\" @click=\"onClearTempFilters\">清空</button>\n\t\t\t\t<button class=\"btn-ok\" @click=\"onConfirmTempFilters\">完成</button>\n\t\t\t</view>\n\t\t</view>\n\t\t<!-- 搜索 -->\n\t\t<view class=\"search-container\">\n\t\t\t<input class=\"search-input\" v-model.trim=\"searchQuery\" placeholder=\"搜索活动名称\" confirm-type=\"search\" />\n\t\t</view>\n\t\t<!-- 筛选 -->\n\t\t<!-- 工具栏：仅筛选按钮 -->\n\t\t<view class=\"toolbar\">\n\t\t\t<button class=\"filter-toggle\" @click=\"openFilterDrawer\">\n\t\t\t\t<image class=\"filter-icon\" src=\"/static/icons/筛选.png\" mode=\"aspectFit\"></image>\n\t\t\t\t<text class=\"filter-text\">筛选</text>\n\t\t\t</button>\n\t\t</view>\n\t\t        <view class=\"activity-card\" v-for=\"(activity, index) in displayedActivities\" :key=\"activity.id || index\">\n            <view class=\"activity-info\">\n                <text class=\"activity-name\">{{ activity.name }}</text>\n                <view v-if=\"activity.type\" class=\"category-row\">\n                  <text class=\"category-tag\">{{ activity.type }}</text>\n                </view>\n                <text class=\"activity-location\">{{ fullLocation(activity) }}</text>\n                <text class=\"activity-time\">{{ activity.date }} {{ activity.timeSlot }}{{ activity.endtime ? (' - ' + activity.endtime) : '' }}</text>\n                <text class=\"activity-count\">需要人数: {{ activity.totalPeople }} / 已报名: {{ activity.joinedPeople }}</text>\n            </view>\n            <button class=\"detail-button\" :data-id=\"activity.id || activity._id\" :data-index=\"index\" @click=\"viewDetail\">查看详情</button>\n        </view>\n\t\t\n\t\t<!-- 空状态提示 -->\n\t\t<view v-if=\"!loading && activityList.length === 0\" class=\"empty-tips\">\n\t\t\t<text>暂无活动，下拉刷新或点击底部\"创建\"发起活动</text>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tselectedDate: null,\n\t\t\t\tselectedStartTime: '',\n\t\t\t\tselectedAreaIndex: null,\n\t\t\t\tselectedTypeIndex: null,\n\t\t\t\tareas: ['越秀区','荔湾区','海珠区','天河区','白云区','黄埔区','番禺区','花都区','南沙区','从化区','增城区'],\n\t\t\t\ttypes: ['运动','户外','音乐','艺术','其他'],\n\t\t\t\tsearchQuery: '',\n\t\t\t\ttempDatePickerValue: '',\n\t\t\t\t// 抽屉筛选相关\n\t\t\t\tfilterDrawerVisible: false,\n\t\t\t\tfilterActiveTab: 'date', // 'date' | 'time' | 'area' | 'type'\n\t\t\t\ttempSelectedDate: null,\n\t\t\t\t// 抽屉中的开始时间（临时值）\n\t\t\t\ttempSelectedStartTime: '',\n\t\t\t\t// 临时多列：小时、分钟\n\t\t\t\ttempHours: [],\n\t\t\t\ttempMinutes: [],\n\t\t\t\ttempStartPickerIndex: [0, 0, 0],\n\t\t\t\ttempSelectedAreaIndex: null,\n\t\t\t\ttempSelectedTypeIndex: null,\n\t\t\t\tdateOptions: [],\n\t\t\t\t// 开始时间多列选择数据\n\t\t\t\thours: Array.from({ length: 24 }, (_, i) => String(i).padStart(2, '0')),\n\t\t\t\tminutes: Array.from({ length: 60 }, (_, i) => String(i).padStart(2, '0')),\n\t\t\t\tstartPickerIndex: [0, 0, 0],\n\t\t\t\tactivityList: [], // 存储从云数据库获取的活动列表\n\t\t\t\trefreshing: false, // 是否正在刷新\n\t\t\t\tloading: false // 是否正在加载\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\tdisplayedActivities() {\n\t\t\t\tif (!this.selectedDate && !this.selectedStartTime && this.selectedAreaIndex === null && this.selectedTypeIndex === null && !this.searchQuery) {\n\t\t\t\t\treturn this.activityList; // 未选择筛选条件时显示全部\n\t\t\t\t}\n\t\t\t\treturn this.activityList.filter(activity => {\n\t\t\t\t\tconst dateMatch = !this.selectedDate || activity.date === this.selectedDate;\n\t\t\t\t\tconst timeMatch = !this.selectedStartTime || String(activity.timeSlot || '') === this.selectedStartTime;\n\t\t\t\t\tconst areaMatch = this.selectedAreaIndex === null || activity.area === this.areas[this.selectedAreaIndex];\n\t\t\t\t\tconst typeMatch = this.selectedTypeIndex === null || activity.type === this.types[this.selectedTypeIndex];\n\t\t\t\t\tconst q = (this.searchQuery || '').trim().toLowerCase();\n\t\t\t\t\tconst nameMatch = !q || String(activity.name || '').toLowerCase().includes(q);\n\t\t\t\t\treturn dateMatch && timeMatch && areaMatch && typeMatch && nameMatch;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonLoad() {\n\t\t\t// 初始化开始时间列（若选择的是今天，则不早于当前时间）\n\t\t\tthis.rebuildStartColumns();\n\t\t\tthis.loadActivities();\n\t\t},\n\t\tonShow() {\n\t// 每次页面显示时刷新数据\n\tconsole.log('首页显示，刷新活动数据...');\n\tthis.loadActivities();\n},\n\t\tonPullDownRefresh() {\n\t\t\tthis.refreshing = true;\n\t\t\tthis.loadActivities();\n\t\t},\n\t\tmethods: {\n            fullLocation(a) {\n                try {\n                    const base = '广东省广州市';\n                    const area = String((a && a.area) || '').trim();\n                    const detail = String((a && a.location) || '').trim();\n                    // 若旧数据的 location 已包含省市信息，则直接返回，避免重复\n                    if (/广东省|广州市/.test(detail)) return detail;\n                    if (area && detail) return `${base}${area} ${detail}`;\n                    if (area) return `${base}${area}`;\n                    if (detail) return `${base}${detail}`;\n                    return '';\n                } catch(_) { return String((a && a.location) || ''); }\n            },\n\t\t\tonDateChange(e) {\n\t\t\t\tthis.selectedDate = e.detail.value;\n\t\t\t\tconsole.log('选择的日期:', this.selectedDate);\n\t\t\t\t// 日期变化时，重建开始时间可选列，并校验已选开始时间\n\t\t\t\ttry {\n\t\t\t\t\tthis.rebuildStartColumns();\n\t\t\t\t\tconst minStart = this.getMinStartForSelectedDate();\n\t\t\t\t\tif (this.selectedStartTime && this.compareTime(this.selectedStartTime, minStart) < 0) {\n\t\t\t\t\t\tthis.selectedStartTime = '';\n\t\t\t\t\t}\n\t\t\t\t} catch(_) {}\n\t\t\t},\n\t\t\topenFilterDrawer() {\n\t\t\t\t// 将当前选择复制到临时变量\n\t\t\t\tthis.tempSelectedDate = this.selectedDate || null;\n\t\t\t\tthis.tempSelectedStartTime = this.selectedStartTime || '';\n\t\t\t\tthis.tempSelectedAreaIndex = this.selectedAreaIndex !== null ? this.selectedAreaIndex : null;\n\t\t\t\tthis.tempSelectedTypeIndex = this.selectedTypeIndex !== null ? this.selectedTypeIndex : null;\n\t\t\t\tthis.tempDatePickerValue = this.selectedDate || '';\n\t\t\t\tthis.filterActiveTab = 'date';\n\t\t\t\tthis.filterDrawerVisible = true;\n\t\t\t\t// 初始化抽屉内开始时间列\n\t\t\t\tthis.rebuildTempStartColumns();\n\t\t\t},\n\t\t\tcloseFilterDrawer() {\n\t\t\t\tthis.filterDrawerVisible = false;\n\t\t\t},\n\t\t\tonClearTempFilters() {\n\t\t\t\tthis.tempSelectedDate = null;\n\t\t\t\tthis.tempSelectedStartTime = '';\n\t\t\t\tthis.tempSelectedAreaIndex = null;\n\t\t\t\tthis.tempSelectedTypeIndex = null;\n\t\t\t\tthis.tempDatePickerValue = '';\n\t\t\t},\n\t\t\tonConfirmTempFilters() {\n\t\t\t\tthis.selectedDate = this.tempSelectedDate;\n\t\t\t\tthis.selectedStartTime = this.tempSelectedStartTime || '';\n\t\t\t\tthis.selectedAreaIndex = this.tempSelectedAreaIndex;\n\t\t\t\tthis.selectedTypeIndex = this.tempSelectedTypeIndex;\n\t\t\t\tthis.filterDrawerVisible = false;\n\t\t\t},\n\t\t\tclearTempDate() {\n\t\t\t\tthis.tempSelectedDate = null;\n\t\t\t\tthis.tempDatePickerValue = '';\n\t\t\t},\n\t\t\tonTempDatePicked(e) {\n\t\t\t\tconst val = e.detail && e.detail.value ? e.detail.value : '';\n\t\t\t\tthis.tempDatePickerValue = val;\n\t\t\t\tthis.tempSelectedDate = val || null;\n\t\t\t\t// 日期变更：重建抽屉内开始时间列，并校验临时时间\n\t\t\t\tthis.rebuildTempStartColumns();\n\t\t\t\tconst minStart = this.getMinStartForTempDate();\n\t\t\t\tif (this.tempSelectedStartTime && this.compareTime(this.tempSelectedStartTime, minStart) < 0) {\n\t\t\t\t\tthis.tempSelectedStartTime = '';\n\t\t\t\t}\n\t\t\t},\n\t\t\t// —— 抽屉内开始时间（临时）列构建与联动 ——\n\t\t\tgetMinStartForTempDate() {\n\t\t\t\tif (!this.tempSelectedDate) return '00:00';\n\t\t\t\tconst today = this.formatDate(new Date());\n\t\t\t\tif (this.tempSelectedDate === today) {\n\t\t\t\t\tconst now = new Date();\n\t\t\t\t\treturn `${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;\n\t\t\t\t}\n\t\t\t\treturn '00:00';\n\t\t\t},\n\t\t\trebuildTempStartColumns() {\n\t\t\t\tconst minStart = this.getMinStartForTempDate();\n\t\t\t\tconst [minH, minM] = minStart.split(':').map(s => parseInt(s, 10));\n\t\t\t\tthis.tempHours = Array.from({ length: 24 - minH }, (_, i) => String(minH + i).padStart(2, '0'));\n\t\t\t\tconst curHour = this.tempHours[Math.max(0, Math.min(this.tempStartPickerIndex[0], this.tempHours.length - 1))] || String(minH).padStart(2, '0');\n\t\t\t\tthis.tempMinutes = this.getTempMinutesForHour(curHour);\n\t\t\t\tlet hIdx = this.tempHours.indexOf(curHour);\n\t\t\t\tif (hIdx < 0) hIdx = 0;\n\t\t\t\tlet mIdx = Math.max(0, Math.min(this.tempStartPickerIndex[2] || 0, this.tempMinutes.length - 1));\n\t\t\t\tthis.tempStartPickerIndex = [hIdx, 0, mIdx];\n\t\t\t},\n\t\t\tgetTempMinutesForHour(h) {\n\t\t\t\tconst minStart = this.getMinStartForTempDate();\n\t\t\t\tconst [minH, minM] = minStart.split(':').map(s => parseInt(s, 10));\n\t\t\t\tconst hourNum = parseInt(h, 10);\n\t\t\t\tif (hourNum === minH) {\n\t\t\t\t\treturn Array.from({ length: 60 - minM }, (_, i) => String(minM + i).padStart(2, '0'));\n\t\t\t\t}\n\t\t\t\treturn Array.from({ length: 60 }, (_, i) => String(i).padStart(2, '0'));\n\t\t\t},\n\t\t\tonTempStartTimeMultiChange(e) {\n\t\t\t\tconst [hIdx, _sep, mIdx] = e.detail.value;\n\t\t\t\tthis.tempStartPickerIndex = [hIdx, 0, mIdx];\n\t\t\t\tconst h = this.tempHours[hIdx];\n\t\t\t\tconst m = this.tempMinutes[mIdx];\n\t\t\t\tthis.tempSelectedStartTime = `${h}:${m}`;\n\t\t\t},\n\t\t\tonTempStartTimeMultiColumnChange(e) {\n\t\t\t\tconst { column, value } = e.detail;\n\t\t\t\tconst idx = [...this.tempStartPickerIndex];\n\t\t\t\tif (column === 0) idx[0] = value;\n\t\t\t\tif (column === 2) idx[2] = value;\n\t\t\t\tthis.tempStartPickerIndex = idx;\n\t\t\t\tif (column === 0) {\n\t\t\t\t\tconst h = this.tempHours[this.tempStartPickerIndex[0]];\n\t\t\t\t\tthis.tempMinutes = this.getTempMinutesForHour(h);\n\t\t\t\t\tif (this.tempStartPickerIndex[2] >= this.tempMinutes.length) this.tempStartPickerIndex[2] = 0;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// —— 开始时间选择（与创建页相同约束） ——\n\t\t\tisTodaySelected() {\n\t\t\t\tif (!this.selectedDate) return false;\n\t\t\t\tconst today = this.formatDate(new Date());\n\t\t\t\treturn this.selectedDate === today;\n\t\t\t},\n\t\t\tgetMinStartForSelectedDate() {\n\t\t\t\tif (this.isTodaySelected()) {\n\t\t\t\t\tconst now = new Date();\n\t\t\t\t\tconst hh = String(now.getHours()).padStart(2, '0');\n\t\t\t\t\tconst mm = String(now.getMinutes()).padStart(2, '0');\n\t\t\t\t\treturn `${hh}:${mm}`;\n\t\t\t\t}\n\t\t\t\treturn '00:00';\n\t\t\t},\n\t\t\trebuildStartColumns() {\n\t\t\t\tconst minStart = this.getMinStartForSelectedDate();\n\t\t\t\tconst [minH, minM] = minStart.split(':').map(s => parseInt(s, 10));\n\t\t\t\t// 小时列\n\t\t\t\tthis.hours = Array.from({ length: 24 - minH }, (_, i) => String(minH + i).padStart(2, '0'));\n\t\t\t\t// 当前选中小时\n\t\t\t\tconst currentHour = this.hours[Math.max(0, Math.min(this.startPickerIndex[0], this.hours.length - 1))] || String(minH).padStart(2, '0');\n\t\t\t\t// 分钟列\n\t\t\t\tthis.minutes = this.getStartMinutesForHour(currentHour);\n\t\t\t\t// 调整索引\n\t\t\t\tlet hIdx = this.hours.indexOf(currentHour);\n\t\t\t\tif (hIdx < 0) hIdx = 0;\n\t\t\t\tlet mIdx = Math.max(0, Math.min(this.startPickerIndex[2] || 0, this.minutes.length - 1));\n\t\t\t\tthis.startPickerIndex = [hIdx, 0, mIdx];\n\t\t\t},\n\t\t\tgetStartMinutesForHour(h) {\n\t\t\t\tconst minStart = this.getMinStartForSelectedDate();\n\t\t\t\tconst [minH, minM] = minStart.split(':').map(s => parseInt(s, 10));\n\t\t\t\tconst hourNum = parseInt(h, 10);\n\t\t\t\tif (hourNum === minH) {\n\t\t\t\t\treturn Array.from({ length: 60 - minM }, (_, i) => String(minM + i).padStart(2, '0'));\n\t\t\t\t}\n\t\t\t\treturn Array.from({ length: 60 }, (_, i) => String(i).padStart(2, '0'));\n\t\t\t},\n\t\t\tonStartTimeMultiChange(e) {\n\t\t\t\tconst [hIdx, _uh, mIdx] = e.detail.value;\n\t\t\t\tthis.startPickerIndex = [hIdx, 0, mIdx];\n\t\t\t\tconst h = this.hours[hIdx];\n\t\t\t\tconst m = this.minutes[mIdx];\n\t\t\t\tthis.selectedStartTime = `${h}:${m}`;\n\t\t\t},\n\t\t\tonStartTimeMultiColumnChange(e) {\n\t\t\t\tconst { column, value } = e.detail;\n\t\t\t\tconst idx = [...this.startPickerIndex];\n\t\t\t\tif (column === 0) idx[0] = value;\n\t\t\t\tif (column === 2) idx[2] = value;\n\t\t\t\tthis.startPickerIndex = idx;\n\t\t\t\t// 联动分钟列\n\t\t\t\tif (column === 0) {\n\t\t\t\t\tconst h = this.hours[this.startPickerIndex[0]];\n\t\t\t\t\tthis.minutes = this.getStartMinutesForHour(h);\n\t\t\t\t\tif (this.startPickerIndex[2] >= this.minutes.length) {\n\t\t\t\t\t\tthis.startPickerIndex[2] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tformatDate(d) {\n\t\t\t\tconst y = d.getFullYear();\n\t\t\t\tconst m = (d.getMonth() + 1).toString().padStart(2, '0');\n\t\t\t\tconst da = d.getDate().toString().padStart(2, '0');\n\t\t\t\treturn `${y}-${m}-${da}`;\n\t\t\t},\n\t\t\tcompareTime(a, b) {\n\t\t\t\tconst toMin = (t) => {\n\t\t\t\t\tconst [h, m] = String(t).split(':');\n\t\t\t\t\treturn (parseInt(h, 10) || 0) * 60 + (parseInt(m, 10) || 0);\n\t\t\t\t};\n\t\t\t\treturn toMin(a) - toMin(b);\n\t\t\t},\n\t\t\tasync loadActivities() {\n\t\t\t\ttry {\n\t\t\t\t\tconsole.log('开始加载活动数据...');\n\t\t\t\t\tthis.loading = true;\n\t\t\t\t\tuni.showLoading({ title: '加载中...' });\n\t\t\t\t\t\n\t\t\t\t\t// 添加时间戳参数避免缓存\n\t\t\t\t\tconst timestamp = new Date().getTime();\n\t\t\t\t\t\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'getActivities',\n\t\t\t\t\t\tdata: { _t: timestamp }, // 添加时间戳参数\n\t\t\t\t\t\ttimeout: 10000\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tconsole.log('获取到的活动数据:', res);\n\t\t\t\t\t\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\t// 确保每个活动都有唯一的ID\n\t\t\t\t\t\tthis.activityList = res.result.data.map(activity => ({\n\t\t\t\t\t\t\t...activity,\n\t\t\t\t\t\t\tid: activity.id || activity._id // 确保有id字段\n\t\t\t\t\t\t}));\n\t\t\t\t\t\t// 生成日期选项（去重排序）\n\t\t\t\t\t\tconst dates = Array.from(new Set(this.activityList.map(a => a.date).filter(Boolean)));\n\t\t\t\t\t\ttry { dates.sort(); } catch(_) {}\n\t\t\t\t\t\tthis.dateOptions = dates;\n\t\t\t\t\t\t// 地区选项固定为创建页的选项，保持一致，不在此处动态覆盖\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log('成功加载活动数据，数量:', this.activityList.length);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(res.result.message || '加载活动失败');\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.error('加载活动错误:', err);\n\t\t\t\t\tuni.showToast({ \n\t\t\t\t\t\ttitle: '加载失败: ' + (err.message || '网络错误'), \n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 3000\n\t\t\t\t\t});\n\t\t\t\t} finally {\n\t\t\t\t\tthis.loading = false;\n\t\t\t\t\tthis.refreshing = false;\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t// 停止下拉刷新动画\n\t\t\t\t\tuni.stopPullDownRefresh();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonAreaChange(e) {\n\t\t\t\tthis.selectedAreaIndex = Number(e.detail.value);\n\t\t\t\tconsole.log('选择的地区索引:', this.selectedAreaIndex, '值:', this.areas[this.selectedAreaIndex]);\n\t\t\t},\n\t\t\tviewDetail(e) {\n                const dataset = e && e.currentTarget ? e.currentTarget.dataset || {} : {};\n                console.log('查看详情点击，dataset:', dataset);\n                const idFromDataset = dataset.id;\n                let activity = null;\n                if (idFromDataset) {\n                    // 优先通过 id 在完整列表中查找，避免筛选/排序导致索引错位\n                    activity = this.activityList.find(a => (a.id || a._id) === idFromDataset) || null;\n                }\n                if (!activity) {\n                    // 回退：通过当前展示列表索引\n                    const idx = typeof dataset.index !== 'undefined' ? Number(dataset.index) : undefined;\n                    activity = typeof idx !== 'undefined' ? this.displayedActivities[idx] : null;\n                }\n                if (!activity) {\n                    console.error('错误：活动数据为空', activity);\n                    uni.showToast({ \n                        title: '活动数据无效', \n                        icon: 'none',\n                        duration: 2000\n                    });\n                    return;\n                }\n                const id = activity.id || activity._id;\n                if (!id) {\n                    console.error('错误：活动缺少 id/_id', activity);\n                    uni.showToast({ \n                        title: '活动数据缺少id', \n                        icon: 'none',\n                        duration: 2000\n                    });\n                    return;\n                }\n                const url = `/pages/detailActivity/detailActivity?id=${encodeURIComponent(id)}`;\n                console.log('跳转详情页，参数:', { id, url });\n                uni.navigateTo({\n                    url,\n                    success: (res) => {\n                        try {\n                            // 通过 eventChannel 传递完整活动数据，详情页可立即渲染\n                            res.eventChannel && res.eventChannel.emit && res.eventChannel.emit('activityPrefill', { activity });\n                        } catch (e) {\n                            console.warn('eventChannel 传递活动数据失败，不影响跳转:', e);\n                        }\n                    },\n                    fail: (err) => {\n                        console.error('跳转失败:', err);\n                        uni.showToast({ \n                            title: '跳转页面失败', \n                            icon: 'none',\n                            duration: 2000\n                        });\n                    }\n                });\n            },\n\t\t\tcreateActivity() {\n\t\t\t\tconsole.log(\"创建新活动按钮被点击\");\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/pages/createActivity/createActivity',\n\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\tconsole.error(\"跳转失败:\", err);\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '跳转失败，请检查页面是否存在',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tresetFilters() {\n\t\t\t\tthis.selectedDate = null;\n\t\t\t\tthis.selectedTime = null;\n\t\t\t\tthis.selectedAreaIndex = null;\n\t\t\t\tthis.searchQuery = '';\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '已清除筛选条件',\n\t\t\t\t\ticon: 'success'\n\t\t\t\t});\n\t\t\t},\n\t\t\tasync loadActivityDetail() {\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await uniCloud.callFunction({\n\t\t\t\t\t\tname: 'getActivityDetail',\n\t\t\t\t\t\tdata: { id: this.activityId },\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log('云函数返回数据:', res.result); // 重点检查这里\n\t\t\t\t\tif (res.result.code === 0) {\n\t\t\t\t\t\tthis.activityData = { ...this.activityData, ...res.result.data };\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(res.result.message || '数据加载失败');\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.error('详情加载失败:', err);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t/* 搜索 */\n\t.search-container {\n\t\tpadding: 0 0 8rpx;\n\t\tmargin: 0 20rpx 8rpx 20rpx;\n\t}\n\t.search-input {\n\t\theight: 70rpx;\n\t\twidth: 100%;\n\t\tpadding: 0 24rpx;\n\t\tborder: 1rpx solid #e0e0e0;\n\t\tborder-radius: 32rpx;\n\t\tfont-size: 28rpx;\n\t\tbackground-color: #fff;\n\t\tbox-sizing: border-box;\n\t}\n\n\t/* 工具栏 */\n\t.toolbar {\n\t\tdisplay: flex;\n\t\tjustify-content: flex-start; /* 左对齐 */\n\t\tmargin: 0 20rpx 12rpx 20rpx; /* 与搜索框左右留白一致 */\n\t\tpadding: 0; /* 避免内边距导致不对齐 */\n\t}\n\t.filter-toggle {\n\t\tdisplay: inline-flex;\n\t\talign-items: center;\n\t\tgap: 10rpx;\n\t\tbackground-color: #fff;\n\t\tborder: 1rpx solid #e0e0e0;\n\t\tborder-radius: 24rpx;\n\t\tpadding: 8rpx 20rpx;\n\t\tfont-size: 26rpx;\n\t\tcolor: #333;\n\t\tmargin: 0; /* 去除默认按钮外边距 */\n\t}\n\t.filter-icon { width: 32rpx; height: 32rpx; }\n\t.filter-text { line-height: 32rpx; }\n\n\t/* 抽屉遮罩 */\n\t.drawer-mask {\n\t\tposition: fixed;\n\t\tleft: 0; right: 0; top: 0; bottom: 0;\n\t\tbackground: rgba(0,0,0,0.35);\n\t\tz-index: 10000; /* 高于自定义 tabbar */\n\t}\n\n\t/* 抽屉容器 */\n\t.filter-drawer {\n\t\tposition: fixed;\n\t\ttop: 0; bottom: 0; left: -75%;\n\t\twidth: 75%;\n\t\tbackground: #fff;\n\t\tz-index: 10001; /* 高于遮罩与 tabbar */\n\t\tbox-shadow: 4rpx 0 20rpx rgba(0,0,0,0.08);\n\t\ttransition: left 0.25s ease;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t.filter-drawer.show { left: 0; }\n\n\t.drawer-header {\n\t\tpadding: 28rpx 24rpx;\n\t\tfont-size: 32rpx;\n\t\tfont-weight: 600;\n\t\tborder-bottom: 1rpx solid #f0f0f0;\n\t}\n\n\t.drawer-body {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tmin-height: 0;\n\t}\n\n\t.drawer-left {\n\t\twidth: 32%;\n\t\tborder-right: 1rpx solid #f5f5f5;\n\t\tbackground: #fafafa;\n\t}\n\t.drawer-tab {\n\t\tpadding: 24rpx;\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t}\n\t.drawer-tab.active {\n\t\tbackground: #fff;\n\t\tcolor: #007AFF;\n\t\tfont-weight: 600;\n\t}\n\n\t.drawer-right {\n\t\tflex: 1;\n\t\tpadding: 16rpx;\n\t\toverflow-y: auto;\n\t}\n\t.option-list { display: flex; flex-wrap: wrap; gap: 12rpx; }\n\t/* 纵向排列用于日期“不限/选择” */\n\t.option-list.option-list-column {\n\t\tflex-direction: column;\n\t\tflex-wrap: nowrap;\n\t\tgap: 16rpx;\n\t}\n\t.option-item {\n\t\tpadding: 14rpx 22rpx;\n\t\tborder: 1rpx solid #e0e0e0;\n\t\tborder-radius: 24rpx;\n\t\tfont-size: 26rpx;\n\t\tcolor: #333;\n\t\tbackground: #fff;\n\t}\n\t.option-item.selected {\n\t\tborder-color: #007AFF;\n\t\tcolor: #007AFF;\n\t\tbackground: #E6F0FF;\n\t}\n\n\t.drawer-actions {\n\t\tdisplay: flex;\n\t\tgap: 16rpx;\n\t\tpadding: 12rpx 16rpx calc(24rpx + constant(safe-area-inset-bottom));\n\t\tpadding-bottom: calc(24rpx + env(safe-area-inset-bottom));\n\t\tborder-top: 1rpx solid #f0f0f0;\n\t}\n\t.btn-clear {\n\t\tflex: 1;\n\t\tbackground: #f5f5f5;\n\t\tcolor: #666;\n\t\tborder-radius: 8rpx;\n\t\tpadding: 18rpx 0;\n\t\tfont-size: 28rpx;\n\t}\n\t.btn-ok {\n\t\tflex: 1;\n\t\tbackground: #007AFF;\n\t\tcolor: #fff;\n\t\tborder-radius: 8rpx;\n\t\tpadding: 18rpx 0;\n\t\tfont-size: 28rpx;\n\t}\n\t.filter-container {\n\t\tpadding: 20rpx;\n\t\tmargin: 20rpx;\n\t\tmargin-right: 20rpx;\n\t\tbackground-color: #f8f8f8;\n\t\tborder-bottom: 1rpx solid #eee;\n\t\tborder-radius: 16rpx;\n\t\tbox-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\n\t\tdisplay: block;\n\t\tpadding-bottom: 20rpx;\n\t}\n\t.picker {\n\t\tpadding: 15rpx 20rpx;\n\t\tbackground-color: white;\n\t\tborder: 1rpx solid #e0e0e0;\n\t\tborder-radius: 12rpx;\n\t\twidth: 100%;\n\t\tfont-size: 28rpx;\n\t\tcolor: #333;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmargin-bottom: 15rpx;\n\t}\n\t.picker:last-child {\n\t\tmargin-bottom: 0;\n\t}\n\t.activities-container {\n\t\tpadding: 20rpx;\n\t\tpadding-right: 20rpx;\n\t\tpadding-bottom: 100rpx;\n\t\tbackground-color: #f5f7fa;\n\t}\n\n\t.activity-card {\n\t\twidth: calc(100% - 40rpx);\n\t\tmargin-right: 20rpx;\n\t\tpadding: 25rpx;\n\t\tmargin-bottom: 25rpx;\n\t\tborder: 1rpx solid #e8e8e8;\n\t\tborder-radius: 16rpx;\n\t\tposition: relative;\n\t\tbackground-color: white;\n\t\tbox-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.03);\n\t}\n\n\t.activity-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmargin-bottom: 50rpx;\n\t}\n\n\t.activity-name {\n\t\tfont-size: 34rpx;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 12rpx;\n\t\tcolor: #333;\n\t}\n\n\t.activity-location {\n\t\tfont-size: 28rpx;\n\t\tcolor: #666;\n\t\tmargin-bottom: 12rpx;\n\t}\n\n\t.activity-time {\n\t\tfont-size: 26rpx;\n\t\tcolor: #888;\n\t\tmargin-bottom: 12rpx;\n\t}\n\n\t.activity-count {\n\t\tfont-size: 26rpx;\n\t\tcolor: #888;\n\t}\n\n\t.detail-button {\n\t\tposition: absolute;\n\t\tright: 20rpx;\n\t\tbottom: 20rpx;\n\t\tbackground-color: #007AFF;\n\t\tcolor: white;\n\t\tborder-radius: 10rpx;\n\t\tpadding: 8rpx 20rpx;\n\t\tfont-size: 26rpx;\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0, 122, 255, 0.2);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t/* 空状态提示 */\n\t.empty-tips {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\theight: 200rpx;\n\t\tcolor: #999;\n\t\tfont-size: 28rpx;\n\t}\n\n\t.reset-button {\n\t\tmargin-top: 15rpx;\n\t\theight: 80rpx;\n\t\tbackground-color: #f8f8f8;\n\t\tcolor: #666;\n\t\tborder: 1rpx solid #e0e0e0;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.reset-button:active {\n\t\tbackground-color: #eee;\n\t}\n\n\t\n\t.reset-button[disabled] {\n\t\topacity: 0.5;\n\t\tbackground-color: #f8f8f8;\n\t}\n\t/* 下拉刷新样式 */\n\t.refresh-container {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tpadding: 20rpx 0;\n\t\tfont-size: 28rpx;\n\t\tcolor: #999;\n\t}\n\t\n\t.refresh-text {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\t\n\t/* 空状态提示 */\n\t.empty-tips {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\theight: 200rpx;\n\t\tcolor: #999;\n\t\tfont-size: 28rpx;\n\t}\n\t\n\t/* 活动卡片样式 */\n\t.activity-card {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tbackground-color: #fff;\n\t\tborder-radius: 12rpx;\n\t\tpadding: 24rpx;\n\t\tmargin-bottom: 24rpx;\n\t\tbox-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.05);\n\t}\n\t\n\t.activity-info {\n\t\tflex: 1;\n\t}\n\t\n\t.activity-name {\n\t\tdisplay: block;\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 8rpx;\n\t\tcolor: #333;\n\t}\n\t\n\t.activity-location,\n\t.activity-time,\n\t.activity-count {\n\t\tdisplay: block;\n\t\tfont-size: 26rpx;\n\t\tcolor: #666;\n\t\tmargin-top: 6rpx;\n\t}\n\t\n\t.detail-button {\n\t\tbackground-color: #007AFF;\n\t\tcolor: #fff;\n\t\tfont-size: 26rpx;\n\t\tpadding: 10rpx 24rpx;\n\t\tborder-radius: 30rpx;\n\t\tmargin-left: 20rpx;\n\t}\n\t\n\t/* 筛选区域样式 */\n\t.filter-container {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 12rpx;\n\t\tjustify-content: space-between;\n\t\tpadding: 12rpx 0;\n\t\tmargin-bottom: 20rpx;\n\t}\n\n\t.picker {\n\t\tbackground-color: #fff;\n\t\tpadding: 12rpx 18rpx;\n\t\tborder-radius: 8rpx;\n\t\tfont-size: 26rpx;\n\t\tcolor: #333;\n\t\tflex: 1 1 30%;\n\t\tmin-width: 30%;\n\t\twidth: auto; /* 覆盖上方的 width:100% */\n\t\tmargin: 0;\n\t\tbox-sizing: border-box;\n\t}\n\n\t.reset-button {\n\t\tbackground-color: #f8f8f8;\n\t\tcolor: #666;\n\t\tfont-size: 26rpx;\n\t\tpadding: 0 20rpx;\n\t\theight: 64rpx;\n\t\tline-height: 64rpx;\n\t\tborder-radius: 32rpx;\n\t\tflex: 1 1 30%;\n\t\tmin-width: 30%;\n\t\tmargin: 0;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.reset-button[disabled] {\n\t\topacity: 0.5;\n\t}\n\n\t/* 类别标签样式 */\n\t.category-row {\n\t\tmargin: 4rpx 0 10rpx 0;\n\t}\n\n\t.category-tag {\n\t\tdisplay: inline-block;\n\t\tpadding: 6rpx 16rpx;\n\t\tfont-size: 22rpx;\n\t\tfont-weight: 600;\n\t\tline-height: 1;\n\t\tcolor: #0A84FF; /* 与背景形成对比的主色 */\n\t\tbackground-color: rgba(10, 132, 255, 0.12); /* 半透明背景 */\n\t\tborder: 1rpx solid rgba(10, 132, 255, 0.35);\n\t\tborder-radius: 28rpx; /* 胶囊形状 */\n\t\tbackdrop-filter: saturate(140%) blur(2rpx);\n\t\t/* 使标签不占满整行，更贴近名称下方 */\n\t\talign-self: flex-start;\n\t\ttransform: translateX(-5px);\n\t}\n</style>"],"sourceRoot":""}